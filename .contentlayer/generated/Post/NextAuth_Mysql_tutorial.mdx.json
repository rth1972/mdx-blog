{
  "title": "NextAuth.js Tutorial - MySQL Credentials Setup",
  "date": "2025-09-19T00:00:00.000Z",
  "tags": [
    "Nextjs",
    "MYSQL",
    "NextAuth.js"
  ],
  "body": {
    "raw": "\n### NextAuth.js Tutorial - MySQL Credentials Setup\n\nNextAuth.js is a powerful authentication library. This tutorial shows you how to use the **`CredentialsProvider`** to authenticate users against a **MySQL database**, perfect for a custom email/password login system.\n\n---\n\n### What You Need\n\n- Next.js app (v13+ recommended)\n    \n- MySQL server running\n    \n- A `users` table with `email` and a securely **hashed** `password` column.\n    \n- **`bcrypt`** to compare passwords.\n    \n- **`mysql2`** to connect to the database.\n    \n\n---\n\n### Step 1: Installation\n\nFirst, install the necessary packages. `next-auth` is the core library, `bcrypt` is for secure password comparison, and `mysql2` is for connecting to your MySQL database.\n\nBash\n\n```\nnpm install next-auth bcrypt mysql2\n# or\nyarn add next-auth bcrypt mysql2\n```\n\n---\n\n### Step 2: Environment Variables\n\nCreate a `.env.local` file in your project root. The `NEXTAUTH_SECRET` is crucial for session security, and the `DATABASE_URL` is for your MySQL connection.\n\nCode snippet\n\n```\nNEXTAUTH_URL=\"http://localhost:3000\"\nNEXTAUTH_SECRET=\"your-secure-secret-key-here\"\nDATABASE_URL=\"mysql://username:password@localhost:3306/database_name\"\n```\n\nTo generate a secure `NEXTAUTH_SECRET`, you can use the command: `openssl rand -base64 32`\n\n---\n\n### Step 3: Database Connection Utility\n\nCreate a utility file at `lib/db.js` to manage your database connection. This is the same utility from the previous MySQL tutorial.\n\nJavaScript\n\n```\n// lib/db.js\nimport mysql from 'mysql2/promise';\n\nexport async function createConnection() {\n  const connection = await mysql.createConnection(process.env.DATABASE_URL);\n  return connection;\n}\n```\n\n---\n\n### Step 4: API Route Setup\n\nThis is the most critical step. You'll replace the Google and GitHub providers with `CredentialsProvider`. This provider allows you to define your own login logic.\n\nCreate the file: pages/api/auth/[...nextauth].js (Pages Router)\n\nor app/api/auth/[...nextauth]/route.js (App Router)\n\n#### For Pages Router:\n\nJavaScript\n\n```\n// pages/api/auth/[...nextauth].js\nimport NextAuth from 'next-auth';\nimport CredentialsProvider from 'next-auth/providers/credentials';\nimport bcrypt from 'bcrypt';\nimport { createConnection } from '../../../lib/db';\n\nexport default NextAuth({\n  providers: [\n    CredentialsProvider({\n      name: 'Credentials',\n      credentials: {\n        email: { label: 'Email', type: 'text' },\n        password: { label: 'Password', type: 'password' },\n      },\n      async authorize(credentials) {\n        let connection;\n        try {\n          connection = await createConnection();\n          const [rows] = await connection.execute(\n            'SELECT * FROM users WHERE email = ?',\n            [credentials.email]\n          );\n\n          if (rows.length === 0) {\n            return null; // User not found\n          }\n\n          const user = rows[0];\n          const isPasswordValid = await bcrypt.compare(credentials.password, user.password);\n\n          if (isPasswordValid) {\n            return {\n              id: user.id,\n              name: user.name,\n              email: user.email,\n              image: null, // No profile image for credentials\n            };\n          } else {\n            return null; // Invalid password\n          }\n        } catch (error) {\n          console.error('Authentication Error:', error);\n          return null;\n        } finally {\n          if (connection) {\n            await connection.end();\n          }\n        }\n      },\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user }) {\n      if (user) {\n        token.id = user.id;\n      }\n      return token;\n    },\n    async session({ session, token }) {\n      session.user.id = token.id;\n      return session;\n    },\n  },\n  pages: {\n    signIn: '/auth/signin',\n  },\n});\n```\n\n#### For App Router:\n\nJavaScript\n\n```\n// app/api/auth/[...nextauth]/route.js\nimport NextAuth from 'next-auth';\nimport CredentialsProvider from 'next-auth/providers/credentials';\nimport bcrypt from 'bcrypt';\nimport { createConnection } from '../../../../lib/db';\n\nconst handler = NextAuth({\n  providers: [\n    CredentialsProvider({\n      name: 'Credentials',\n      credentials: {\n        email: { label: 'Email', type: 'text' },\n        password: { label: 'Password', type: 'password' },\n      },\n      async authorize(credentials) {\n        let connection;\n        try {\n          connection = await createConnection();\n          const [rows] = await connection.execute(\n            'SELECT * FROM users WHERE email = ?',\n            [credentials.email]\n          );\n\n          if (rows.length === 0) {\n            return null;\n          }\n\n          const user = rows[0];\n          const isPasswordValid = await bcrypt.compare(credentials.password, user.password);\n\n          if (isPasswordValid) {\n            return {\n              id: user.id,\n              name: user.name,\n              email: user.email,\n              image: null,\n            };\n          } else {\n            return null;\n          }\n        } catch (error) {\n          console.error('Authentication Error:', error);\n          return null;\n        } finally {\n          if (connection) {\n            await connection.end();\n          }\n        }\n      },\n    }),\n  ],\n});\n\nexport { handler as GET, handler as POST };\n```\n\n**What happens here:**\n\n- The `CredentialsProvider` is configured with `email` and `password` fields.\n    \n- The `authorize` function is where your login logic goes. It receives the credentials.\n    \n- We connect to MySQL, query for a user with the matching email, and then use **`bcrypt.compare()`** to safely check if the provided password matches the stored hashed password.\n    \n- If both conditions are met, we return a `user` object. If not, we return `null`, and NextAuth.js handles the login failure.\n    \n\n---\n\n### Step 5: Session Provider Setup\n\nThis step remains the same as in the original tutorial. You must wrap your app with `SessionProvider` to make session data available to your components.\n\n#### For Pages Router:\n\nJavaScript\n\n```\n// pages/_app.js\nimport { SessionProvider } from 'next-auth/react'\n\nexport default function App({\n  Component,\n  pageProps: { session, ...pageProps },\n}) {\n  return (\n    <SessionProvider session={session}>\n      <Component {...pageProps} />\n    </SessionProvider>\n  )\n}\n```\n\n#### For App Router:\n\nJavaScript\n\n```\n// app/providers.js\n'use client'\nimport { SessionProvider } from 'next-auth/react'\n\nexport function Providers({ children }) {\n  return (\n    <SessionProvider>\n      {children}\n    </SessionProvider>\n  )\n}\n// app/layout.js\nimport { Providers } from './providers'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <Providers>\n          {children}\n        </Providers>\n      </body>\n    </html>\n  )\n}\n```\n\n---\n\n### Step 6: Custom Sign-In Page\n\nNextAuth.js provides a built-in sign-in page, but for credentials, you'll need a custom one. We'll use a simple form to collect the email and password.\n\nCreate the file `pages/auth/signin.js` and add the following:\n\nJavaScript\n\n```\n// pages/auth/signin.js\nimport { useState } from 'react';\nimport { signIn } from 'next-auth/react';\nimport { useRouter } from 'next/router';\n\nexport default function SignIn() {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState(null);\n  const router = useRouter();\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError(null);\n\n    const result = await signIn('credentials', {\n      redirect: false,\n      email,\n      password,\n    });\n\n    if (result.error) {\n      setError(result.error);\n    } else {\n      router.push('/'); // Redirect to a protected page on success\n    }\n  };\n\n  return (\n    <div style={{ padding: '20px', maxWidth: '400px', margin: '0 auto' }}>\n      <h1>Sign In</h1>\n      <form onSubmit={handleSubmit}>\n        <div style={{ marginBottom: '10px' }}>\n          <label htmlFor=\"email\">Email:</label>\n          <br />\n          <input\n            type=\"email\"\n            id=\"email\"\n            value={email}\n            onChange={(e) => setEmail(e.target.value)}\n            required\n            style={{ width: '100%', padding: '8px' }}\n          />\n        </div>\n        <div style={{ marginBottom: '10px' }}>\n          <label htmlFor=\"password\">Password:</label>\n          <br />\n          <input\n            type=\"password\"\n            id=\"password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            required\n            style={{ width: '100%', padding: '8px' }}\n          />\n        </div>\n        <button type=\"submit\" style={{ width: '100%', padding: '10px', cursor: 'pointer' }}>\n          Sign In\n        </button>\n      </form>\n      {error && <p style={{ color: 'red', marginTop: '10px' }}>{error}</p>}\n    </div>\n  );\n}\n```\n\n**Key Features:**\n\n- A form to collect the user's `email` and `password`.\n    \n- `signIn('credentials', ...)` is the key function. It sends the data to the `CredentialsProvider` we configured earlier.\n    \n- We use `redirect: false` to handle the success or failure redirect manually.\n    \n\n---\n\n### Step 7: Use in Your Components\n\nThis step is identical to the original tutorial. You'll use `useSession` to check if a user is logged in and conditionally render content.\n\nJavaScript\n\n```\n// components/LoginButton.js\nimport { useSession, signOut } from 'next-auth/react'\n\nexport default function LoginButton() {\n  const { data: session, status } = useSession()\n\n  if (status === \"loading\") return <p>Loading...</p>\n\n  if (session) {\n    return (\n      <div>\n        <p>Signed in as {session.user.email}</p>\n        <button onClick={() => signOut()}>Sign out</button>\n      </div>\n    )\n  }\n  \n  // Note: The sign-in link is now managed by the custom sign-in page\n  return (\n    <div>\n      <p>Not signed in</p>\n      <a href=\"/auth/signin\">Sign in</a>\n    </div>\n  )\n}\n```\n\n---\n\n### Next Steps\n\n- **Registration:** Create a separate API route to handle new user registration. **Remember to hash the password with `bcrypt` before inserting it into the database.**\n    \n- **Error Handling:** The `signIn` function can return specific errors, which you can use to give the user more detailed feedback (e.g., \"Invalid password\" or \"Email not found\").\n    \n- **Session Management:** For more advanced applications, you may want to manage sessions with a database adapter instead of the default JWT session. This is useful for things like revoking sessions or tracking activity.",
    "code": "var Component=(()=>{var u=Object.create;var o=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,f=Object.prototype.hasOwnProperty;var y=(r,n)=>()=>(n||r((n={exports:{}}).exports,n),n.exports),w=(r,n)=>{for(var t in n)o(r,t,{get:n[t],enumerable:!0})},a=(r,n,t,s)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let i of m(n))!f.call(r,i)&&i!==t&&o(r,i,{get:()=>n[i],enumerable:!(s=p(n,i))||s.enumerable});return r};var v=(r,n,t)=>(t=r!=null?u(g(r)):{},a(n||!r||!r.__esModule?o(t,\"default\",{value:r,enumerable:!0}):t,r)),b=r=>a(o({},\"__esModule\",{value:!0}),r);var d=y((P,l)=>{l.exports=_jsx_runtime});var x={};w(x,{default:()=>h,frontmatter:()=>S});var e=v(d()),S={title:\"NextAuth.js Tutorial - MySQL Credentials Setup\",date:\"2025-09-19\",tags:[\"Nextjs\",\"MYSQL\",\"NextAuth.js\"],draft:!1,summary:\"NextAuth.js is a powerful authentication library. This tutorial shows you how to use the **`CredentialsProvider`** to authenticate users against a **MySQL database**, perfect for a custom email/password login system.\",images:[]};function c(r){let n={code:\"code\",h3:\"h3\",h4:\"h4\",hr:\"hr\",li:\"li\",p:\"p\",pre:\"pre\",strong:\"strong\",ul:\"ul\",...r.components};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.h3,{children:\"NextAuth.js Tutorial - MySQL Credentials Setup\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"NextAuth.js is a powerful authentication library. This tutorial shows you how to use the \",(0,e.jsx)(n.strong,{children:(0,e.jsx)(n.code,{children:\"CredentialsProvider\"})}),\" to authenticate users against a \",(0,e.jsx)(n.strong,{children:\"MySQL database\"}),\", perfect for a custom email/password login system.\"]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h3,{children:\"What You Need\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsx)(n.p,{children:\"Next.js app (v13+ recommended)\"}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsx)(n.p,{children:\"MySQL server running\"}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"A \",(0,e.jsx)(n.code,{children:\"users\"}),\" table with \",(0,e.jsx)(n.code,{children:\"email\"}),\" and a securely \",(0,e.jsx)(n.strong,{children:\"hashed\"}),\" \",(0,e.jsx)(n.code,{children:\"password\"}),\" column.\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:(0,e.jsx)(n.code,{children:\"bcrypt\"})}),\" to compare passwords.\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:(0,e.jsx)(n.code,{children:\"mysql2\"})}),\" to connect to the database.\"]}),`\n`]}),`\n`]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h3,{children:\"Step 1: Installation\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"First, install the necessary packages. \",(0,e.jsx)(n.code,{children:\"next-auth\"}),\" is the core library, \",(0,e.jsx)(n.code,{children:\"bcrypt\"}),\" is for secure password comparison, and \",(0,e.jsx)(n.code,{children:\"mysql2\"}),\" is for connecting to your MySQL database.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Bash\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`npm install next-auth bcrypt mysql2\n# or\nyarn add next-auth bcrypt mysql2\n`})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h3,{children:\"Step 2: Environment Variables\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Create a \",(0,e.jsx)(n.code,{children:\".env.local\"}),\" file in your project root. The \",(0,e.jsx)(n.code,{children:\"NEXTAUTH_SECRET\"}),\" is crucial for session security, and the \",(0,e.jsx)(n.code,{children:\"DATABASE_URL\"}),\" is for your MySQL connection.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Code snippet\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`NEXTAUTH_URL=\"http://localhost:3000\"\nNEXTAUTH_SECRET=\"your-secure-secret-key-here\"\nDATABASE_URL=\"mysql://username:password@localhost:3306/database_name\"\n`})}),`\n`,(0,e.jsxs)(n.p,{children:[\"To generate a secure \",(0,e.jsx)(n.code,{children:\"NEXTAUTH_SECRET\"}),\", you can use the command: \",(0,e.jsx)(n.code,{children:\"openssl rand -base64 32\"})]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h3,{children:\"Step 3: Database Connection Utility\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Create a utility file at \",(0,e.jsx)(n.code,{children:\"lib/db.js\"}),\" to manage your database connection. This is the same utility from the previous MySQL tutorial.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"JavaScript\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`// lib/db.js\nimport mysql from 'mysql2/promise';\n\nexport async function createConnection() {\n  const connection = await mysql.createConnection(process.env.DATABASE_URL);\n  return connection;\n}\n`})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h3,{children:\"Step 4: API Route Setup\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"This is the most critical step. You'll replace the Google and GitHub providers with \",(0,e.jsx)(n.code,{children:\"CredentialsProvider\"}),\". This provider allows you to define your own login logic.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"Create the file: pages/api/auth/[...nextauth].js (Pages Router)\"}),`\n`,(0,e.jsx)(n.p,{children:\"or app/api/auth/[...nextauth]/route.js (App Router)\"}),`\n`,(0,e.jsx)(n.h4,{children:\"For Pages Router:\"}),`\n`,(0,e.jsx)(n.p,{children:\"JavaScript\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`// pages/api/auth/[...nextauth].js\nimport NextAuth from 'next-auth';\nimport CredentialsProvider from 'next-auth/providers/credentials';\nimport bcrypt from 'bcrypt';\nimport { createConnection } from '../../../lib/db';\n\nexport default NextAuth({\n  providers: [\n    CredentialsProvider({\n      name: 'Credentials',\n      credentials: {\n        email: { label: 'Email', type: 'text' },\n        password: { label: 'Password', type: 'password' },\n      },\n      async authorize(credentials) {\n        let connection;\n        try {\n          connection = await createConnection();\n          const [rows] = await connection.execute(\n            'SELECT * FROM users WHERE email = ?',\n            [credentials.email]\n          );\n\n          if (rows.length === 0) {\n            return null; // User not found\n          }\n\n          const user = rows[0];\n          const isPasswordValid = await bcrypt.compare(credentials.password, user.password);\n\n          if (isPasswordValid) {\n            return {\n              id: user.id,\n              name: user.name,\n              email: user.email,\n              image: null, // No profile image for credentials\n            };\n          } else {\n            return null; // Invalid password\n          }\n        } catch (error) {\n          console.error('Authentication Error:', error);\n          return null;\n        } finally {\n          if (connection) {\n            await connection.end();\n          }\n        }\n      },\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user }) {\n      if (user) {\n        token.id = user.id;\n      }\n      return token;\n    },\n    async session({ session, token }) {\n      session.user.id = token.id;\n      return session;\n    },\n  },\n  pages: {\n    signIn: '/auth/signin',\n  },\n});\n`})}),`\n`,(0,e.jsx)(n.h4,{children:\"For App Router:\"}),`\n`,(0,e.jsx)(n.p,{children:\"JavaScript\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`// app/api/auth/[...nextauth]/route.js\nimport NextAuth from 'next-auth';\nimport CredentialsProvider from 'next-auth/providers/credentials';\nimport bcrypt from 'bcrypt';\nimport { createConnection } from '../../../../lib/db';\n\nconst handler = NextAuth({\n  providers: [\n    CredentialsProvider({\n      name: 'Credentials',\n      credentials: {\n        email: { label: 'Email', type: 'text' },\n        password: { label: 'Password', type: 'password' },\n      },\n      async authorize(credentials) {\n        let connection;\n        try {\n          connection = await createConnection();\n          const [rows] = await connection.execute(\n            'SELECT * FROM users WHERE email = ?',\n            [credentials.email]\n          );\n\n          if (rows.length === 0) {\n            return null;\n          }\n\n          const user = rows[0];\n          const isPasswordValid = await bcrypt.compare(credentials.password, user.password);\n\n          if (isPasswordValid) {\n            return {\n              id: user.id,\n              name: user.name,\n              email: user.email,\n              image: null,\n            };\n          } else {\n            return null;\n          }\n        } catch (error) {\n          console.error('Authentication Error:', error);\n          return null;\n        } finally {\n          if (connection) {\n            await connection.end();\n          }\n        }\n      },\n    }),\n  ],\n});\n\nexport { handler as GET, handler as POST };\n`})}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"What happens here:\"})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"The \",(0,e.jsx)(n.code,{children:\"CredentialsProvider\"}),\" is configured with \",(0,e.jsx)(n.code,{children:\"email\"}),\" and \",(0,e.jsx)(n.code,{children:\"password\"}),\" fields.\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"The \",(0,e.jsx)(n.code,{children:\"authorize\"}),\" function is where your login logic goes. It receives the credentials.\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"We connect to MySQL, query for a user with the matching email, and then use \",(0,e.jsx)(n.strong,{children:(0,e.jsx)(n.code,{children:\"bcrypt.compare()\"})}),\" to safely check if the provided password matches the stored hashed password.\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"If both conditions are met, we return a \",(0,e.jsx)(n.code,{children:\"user\"}),\" object. If not, we return \",(0,e.jsx)(n.code,{children:\"null\"}),\", and NextAuth.js handles the login failure.\"]}),`\n`]}),`\n`]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h3,{children:\"Step 5: Session Provider Setup\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"This step remains the same as in the original tutorial. You must wrap your app with \",(0,e.jsx)(n.code,{children:\"SessionProvider\"}),\" to make session data available to your components.\"]}),`\n`,(0,e.jsx)(n.h4,{children:\"For Pages Router:\"}),`\n`,(0,e.jsx)(n.p,{children:\"JavaScript\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`// pages/_app.js\nimport { SessionProvider } from 'next-auth/react'\n\nexport default function App({\n  Component,\n  pageProps: { session, ...pageProps },\n}) {\n  return (\n    <SessionProvider session={session}>\n      <Component {...pageProps} />\n    </SessionProvider>\n  )\n}\n`})}),`\n`,(0,e.jsx)(n.h4,{children:\"For App Router:\"}),`\n`,(0,e.jsx)(n.p,{children:\"JavaScript\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`// app/providers.js\n'use client'\nimport { SessionProvider } from 'next-auth/react'\n\nexport function Providers({ children }) {\n  return (\n    <SessionProvider>\n      {children}\n    </SessionProvider>\n  )\n}\n// app/layout.js\nimport { Providers } from './providers'\n\nexport default function RootLayout({ children }) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <Providers>\n          {children}\n        </Providers>\n      </body>\n    </html>\n  )\n}\n`})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h3,{children:\"Step 6: Custom Sign-In Page\"}),`\n`,(0,e.jsx)(n.p,{children:\"NextAuth.js provides a built-in sign-in page, but for credentials, you'll need a custom one. We'll use a simple form to collect the email and password.\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"Create the file \",(0,e.jsx)(n.code,{children:\"pages/auth/signin.js\"}),\" and add the following:\"]}),`\n`,(0,e.jsx)(n.p,{children:\"JavaScript\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`// pages/auth/signin.js\nimport { useState } from 'react';\nimport { signIn } from 'next-auth/react';\nimport { useRouter } from 'next/router';\n\nexport default function SignIn() {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState(null);\n  const router = useRouter();\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError(null);\n\n    const result = await signIn('credentials', {\n      redirect: false,\n      email,\n      password,\n    });\n\n    if (result.error) {\n      setError(result.error);\n    } else {\n      router.push('/'); // Redirect to a protected page on success\n    }\n  };\n\n  return (\n    <div style={{ padding: '20px', maxWidth: '400px', margin: '0 auto' }}>\n      <h1>Sign In</h1>\n      <form onSubmit={handleSubmit}>\n        <div style={{ marginBottom: '10px' }}>\n          <label htmlFor=\"email\">Email:</label>\n          <br />\n          <input\n            type=\"email\"\n            id=\"email\"\n            value={email}\n            onChange={(e) => setEmail(e.target.value)}\n            required\n            style={{ width: '100%', padding: '8px' }}\n          />\n        </div>\n        <div style={{ marginBottom: '10px' }}>\n          <label htmlFor=\"password\">Password:</label>\n          <br />\n          <input\n            type=\"password\"\n            id=\"password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            required\n            style={{ width: '100%', padding: '8px' }}\n          />\n        </div>\n        <button type=\"submit\" style={{ width: '100%', padding: '10px', cursor: 'pointer' }}>\n          Sign In\n        </button>\n      </form>\n      {error && <p style={{ color: 'red', marginTop: '10px' }}>{error}</p>}\n    </div>\n  );\n}\n`})}),`\n`,(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"Key Features:\"})}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"A form to collect the user's \",(0,e.jsx)(n.code,{children:\"email\"}),\" and \",(0,e.jsx)(n.code,{children:\"password\"}),\".\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.code,{children:\"signIn('credentials', ...)\"}),\" is the key function. It sends the data to the \",(0,e.jsx)(n.code,{children:\"CredentialsProvider\"}),\" we configured earlier.\"]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[\"We use \",(0,e.jsx)(n.code,{children:\"redirect: false\"}),\" to handle the success or failure redirect manually.\"]}),`\n`]}),`\n`]}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h3,{children:\"Step 7: Use in Your Components\"}),`\n`,(0,e.jsxs)(n.p,{children:[\"This step is identical to the original tutorial. You'll use \",(0,e.jsx)(n.code,{children:\"useSession\"}),\" to check if a user is logged in and conditionally render content.\"]}),`\n`,(0,e.jsx)(n.p,{children:\"JavaScript\"}),`\n`,(0,e.jsx)(n.pre,{children:(0,e.jsx)(n.code,{children:`// components/LoginButton.js\nimport { useSession, signOut } from 'next-auth/react'\n\nexport default function LoginButton() {\n  const { data: session, status } = useSession()\n\n  if (status === \"loading\") return <p>Loading...</p>\n\n  if (session) {\n    return (\n      <div>\n        <p>Signed in as {session.user.email}</p>\n        <button onClick={() => signOut()}>Sign out</button>\n      </div>\n    )\n  }\n  \n  // Note: The sign-in link is now managed by the custom sign-in page\n  return (\n    <div>\n      <p>Not signed in</p>\n      <a href=\"/auth/signin\">Sign in</a>\n    </div>\n  )\n}\n`})}),`\n`,(0,e.jsx)(n.hr,{}),`\n`,(0,e.jsx)(n.h3,{children:\"Next Steps\"}),`\n`,(0,e.jsxs)(n.ul,{children:[`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Registration:\"}),\" Create a separate API route to handle new user registration. \",(0,e.jsxs)(n.strong,{children:[\"Remember to hash the password with \",(0,e.jsx)(n.code,{children:\"bcrypt\"}),\" before inserting it into the database.\"]})]}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Error Handling:\"}),\" The \",(0,e.jsx)(n.code,{children:\"signIn\"}),' function can return specific errors, which you can use to give the user more detailed feedback (e.g., \"Invalid password\" or \"Email not found\").']}),`\n`]}),`\n`,(0,e.jsxs)(n.li,{children:[`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"Session Management:\"}),\" For more advanced applications, you may want to manage sessions with a database adapter instead of the default JWT session. This is useful for things like revoking sessions or tracking activity.\"]}),`\n`]}),`\n`]})]})}function h(r={}){let{wrapper:n}=r.components||{};return n?(0,e.jsx)(n,{...r,children:(0,e.jsx)(c,{...r})}):c(r)}return b(x);})();\n;return Component;"
  },
  "_id": "NextAuth_Mysql_tutorial.mdx",
  "_raw": {
    "sourceFilePath": "NextAuth_Mysql_tutorial.mdx",
    "sourceFileName": "NextAuth_Mysql_tutorial.mdx",
    "sourceFileDir": ".",
    "contentType": "mdx",
    "flattenedPath": "NextAuth_Mysql_tutorial"
  },
  "type": "Post",
  "url": "/blog/NextAuth_Mysql_tutorial",
  "slug": "NextAuth_Mysql_tutorial",
  "readingTime": 9
}